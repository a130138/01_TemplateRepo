# Variables Replacement - PowerShell

trigger:
- none

pool:
  vmImage: windows-latest

#variables:
#- name: Az1
#  value: $AzTagOwner
#- name: Az2
#  value: jc

steps:
#- task: PowerShell@2
#  inputs:
#    targetType: 'inline'
#    script: (Get-Content -Path $(System.DefaultWorkingDirectory)\05_FileTransform\azuredeploy.json) | foreach{($_.replace('$env','POC'))} | Out-File -FilePath $(System.DefaultWorkingDirectory)\05_FileTransform\azuredeploy.json
    # | Set-Content -Path '$(System.DefaultWorkingDirectory)\05_FileTransform\azuredeploy.json'

- task: PowerShell@2
  inputs:
    filePath: '$(System.DefaultWorkingDirectory)\05_FileTransform\test2.ps1'
    failOnStderr: true

- task: GitHubRelease@1
  inputs:
    gitHubConnection: 'a130138'
    repositoryName: '$(Build.Repository.Name)'
    action: 'edit'
    target: '$(Build.SourceVersion)'
    tag: 'test'
    assetUploadMode: 'replace'
    changeLogCompareToRelease: 'lastFullRelease'
    changeLogType: 'commitBased'

- task: GitHubComment@0
  inputs:
    gitHubConnection: 'a130138'
    repositoryName: '$(Build.Repository.Name)'
    comment: 'test comment'